<ion-view id="lite_route_tracker" ng-init="activeTab=0"
  hide-back-button="true" can-swipe-back="false">
  <ion-nav-buttons side="left">
    <button class="button button-clear back-button"
       ui-sref="tabs.tickets">
       <i class="icon ion-ios-arrow-back"></i>
    </button>
  </ion-nav-buttons>

  <ion-nav-title>Tracking for {{liteRouteLabel}}</ion-nav-title>
  <div class="tabs tabs-top tabs-icon-left tabs-light tabs-striped tabs-color-royal">
    <a class="tab-item" on-tap="activeTab=0" ng-class="{active: activeTab===0}">
      <span class="tab-title-large"><i class="track-nav"></i>Map</a>
    </span>
      <a class="tab-item" on-tap="activeTab=1" ng-class="{active: activeTab===1}">
        <span class="tab-title-large"><i class="track-moreInfo"></i>Info</span>
      </a>
  </div>
  <ion-content class="has-tabs-top" scroll=false>

    <!-- Map Tab -->
    <div ng-show="activeTab===0">
      <route-item class="lite item lite-tracked">
        <route-item-bus-number>
          {{ liteRoute.label }}
        </route-item-bus-number>
        <route-item-description>
          {{ liteRoute.description }}
        </route-item-description>
        <route-item-start-time>
          {{ liteRoute.startTime | formatTime}}
        </route-item-start-time>
        <route-item-start-location>
          {{ liteRoute.from }}
        </route-item-start-location>
        <route-item-start-time>
          {{ liteRoute.endTime | formatTime}}
        </route-item-start-time>
        <route-item-end-location>
          {{ liteRoute.to }}
        </route-item-end-location>
      </route-item>
      <h2 class="item" ng-if="hasNoTrip">
        There is no service at moment.
      </h2>
      <ui-gmap-google-map center="map.center" pan="true" zoom="map.zoom" options="map.options" events="map.events" bounds="map.bounds" dragging="map.dragging" control="map.control" data-tap-disabled="true">
        <my-location></my-location>
        <ui-gmap-polyline path="map.lines.route.path" stroke="map.pathOptions.routePath"></ui-gmap-polyline>
        <ui-gmap-polyline ng-repeat ="actualPath in map.lines.actualPaths"
                          ng-if="actualPath.path.length"
                          path="actualPath.path"
                          stroke="map.pathOptions.actualPath"></ui-gmap-polyline>
        <ui-gmap-marker ng-repeat="busLocation in map.busLocations"
                        ng-if="busLocation.coordinates"
                        idkey="'bus-location{{index}}'"
                        coords="busLocation.coordinates"
                        icon="busLocation.icon"></ui-gmap-marker>
          <ui-gmap-markers  ng-if="tripStops"
                            models="tripStops"
                            idkey="'id'"
                            options="'_markerOptions'"
                            coords="'coordinates'"
                            click="applyTapBoard"
                            ></ui-gmap-markers>
          <ui-gmap-window ng-if="disp.popupStop" coords="disp.popupStop.coordinates"
            show="disp.popupStop">
            <div class="popUpStopSelect">
              <b>{{disp.popupStop.time | formatTimeArray }}</b><br/>
              {{disp.popupStop.description}}<br/>{{disp.popupStop.road}}<br/>
            </div>
          </ui-gmap-window>
      </ui-gmap-google-map>
    </div>

    <!-- Info Tab -->
    <ion-scroll ng-show="activeTab===1">
      <more-info company-id="liteRoute.transportCompanyId">
      </more-info>
    </ion-scroll>
  </ion-content>
</ion-view>
