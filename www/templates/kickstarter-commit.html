<ion-view id="pg_kickstarter_commit" view-title="Joined Route" hide-back-button="true">
  <ion-nav-buttons side="right">
    <button class="button button-clear"
       ui-sref="tabs.kickstarter">
       <i class="icon ion-ios-close-outline"></i>
    </button>
  </ion-nav-buttons>
  <ion-content class="booking-content" scroll=false>
    <ion-item class="item item-text-wrap">
      <div class="row">
        <div class="success-text">
          You are in! You pledge to book this kickstarter route at ${{book.route.bidPrice | number:2}}
          per trip for {{book.route.trips.length}} trips!

          You will be notified via email about the route status when the kickstarter ends on
          {{book.route.notes.lelongExpiry | date:'dd MMM'}}.

          You will be charged when the route activates at this price.
        </div>
      </div>

      <div class="">
        <div class="row">
          <div class="kickstarter-info">
            <route-item>
              <route-item-bus-number>
                {{ book.route.label }}
              </route-item-bus-number>
              <route-item-start-time>
                {{ book.route | routeStartTime | formatTime:true }}
              </route-item-start-time>
              <route-item-start-location>
                {{ book.route.from }}
              </route-item-start-location>
              <route-item-end-time>
                {{ book.route | routeEndTime | formatTime:true }}
              </route-item-end-time>
              <route-item-end-location>
                {{ book.route.to }}
              </route-item-end-location>
              <route-item-additional-info>
                <company-info-broker company-id="book.route.transportCompanyId"
                                      company="companyInfo">
                </company-info-broker>
                <div class="icon-and-schedule">
                  <span class="icon-span company-logo">
                    <img class="mini-icon" ng-src="{{book.route.transportCompanyId | companyLogo}}">
                  </span>
                  <span class="schedule">
                    {{companyInfo.name}}
                  </span>
                </div>

                <div class="icon-and-schedule">
                  <span class="icon-span">
                    <img class="mini-icon" src="img/icon_schedule.svg">
                  </span>
                  <span class="schedule" ng-if="book.route.daysLeft && book.route.daysLeft>1">
                    {{book.route.daysLeft}} days left
                  </span>
                  <span class="schedule" ng-if="book.route.daysLeft && book.route.daysLeft==1">
                    {{book.route.daysLeft}} day left to activate
                  </span>
                </div>
              </route-item-additional-info>
            </route-item>
            <div class="price">
              <fancy-price value="book.bidPrice"></fancy-price>
            </div>
          </div>
        </div>
        <progress-bar cur-val={{book.route.notes.tier[0].no}} second-val={{book.route.notes.tier[1].no}}
          max-val={{book.route.notes.tier[1].pax}} high-price={{book.route.notes.tier[0].price}} low-price={{book.route.notes.tier[1].price}}
          high-total={{book.route.notes.tier[0].pax}}>
        </progress-bar>
      </div>

      Share this route to your friends!
      <div class="row">
        <textarea class="col-60">{{shareLink}}</textarea>
        <button class="col-40 button" ng-click="shareAnywhere()" ng-if="!showCopy">Share anywhere</button>
        <button class="col-40 button" ng-if="showCopy" ngclipboard data-clipboard-text={{shareLink}}>
            Copy
        </button>
      </div>

      <button class="primary-button button" ui-sref="tabs.kickstarter">
        ok
      </button>
    </ion-item>
  </ion-content>
</ion-view>
