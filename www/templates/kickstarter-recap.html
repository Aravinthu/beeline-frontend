<ion-view id="pg_kickstarter_recap" view-title="Your Kickstarter Route Details"
  hide-back-button="false" can-swipe-back="false">
  <ion-content class="has-header">
    <!-- price u bid for -->
    <div class="item item-icon-left item-text-wrap">
        <i class="icon activebid">
            <img src="img/icon_kickstarter_activebid.svg">
        </i>
        You pre-ordered a pass for {{book.route.notes.noPasses}} trips on this route at ${{book.bidPrice | number:2}} per trip. <br />
        <span ng-if="!book.route.isExpired && book.route.isActived">Route is activated. Payment will be deducted when campaign ends and and you will receive the pass.</span>
        <span ng-if="!book.route.isExpired && !book.route.isActived">Route is not activated yet.</span>
    </div>
    <!-- route detail -->
    <div class="item">
      <route-item>
        <route-item-bus-number>
          {{ book.route.label }}
        </route-item-bus-number>
        <route-item-start-time>
          {{ book.route | routeStartTime | formatTime:true }}
        </route-item-start-time>
        <route-item-start-location>
          {{ book.route.from }}
        </route-item-start-location>
        <route-item-end-time>
          {{ book.route | routeEndTime | formatTime:true }}
        </route-item-end-time>
        <route-item-end-location>
          {{ book.route.to }}
        </route-item-end-location>
        <route-item-additional-info>
          <company-info-broker company-id="book.route.transportCompanyId"
                                company="book.companyInfo">
          </company-info-broker>
          <div class="icon-and-schedule">
            <span class="icon-span company-logo">
              <img class="mini-icon" ng-src="{{book.route.transportCompanyId | companyLogo}}">
            </span>
            <span class="mini-info">
              {{book.companyInfo.name}}
            </span>
          </div>

          <div class="icon-and-schedule">
            <span class="icon-span">
              <img class="mini-icon" src="img/icon_kickstarter_timeleft.svg">
            </span>
            <span class="mini-info" ng-if="book.route.daysLeft && book.route.daysLeft>1">
              Campaign ends in {{book.route.daysLeft}} days
            </span>
            <span class="mini-info" ng-if="book.route.daysLeft && book.route.daysLeft==1">
              Campaign ends in {{book.route.daysLeft}} day
            </span>
            <span class="mini-info" ng-if="book.route.isExpired">
              Campaign has expired
            </span>
          </div>
          <div class="icon-and-schedule">
            <span class="icon-span">
              <img class="mini-icon" src="img/icon_schedule.svg">
            </span>
            <span class="mini-info">
              Route starts on {{book.route.trips[0].date | date:'dd MMM yyyy'}} if activated
            </span>
          </div>
        </route-item-additional-info>
      </route-item>
      <progress-bar backer1="book.route.notes.tier[0].count"
        price1="book.route.notes.tier[0].price"
        pax1="book.route.notes.tier[0].pax"
        detail=true
        needed="book.route.notes.tier[0].moreNeeded">
      </progress-bar>
      <div class="icon-and-schedule">
        <span class="icon-span">
          <img class="mini-icon" src="img/icon_kickstarter_status.svg">
        </span>
        <span class="mini-info">
          {{book.route.status}}
        </span>
      </div>
    </div>
    <ion-list>
      <ion-item class="item-icon-right" ng-click="showStops()">
          View Stops
            <i class="icon ion-ios-arrow-right"></i>
      </ion-item>
    </ion-list>
    <div class="item item-text-wrap">
      <div class="item-subtitle">
      What happens next?
      </div>
      <div class="kickstarter-info">
        <p>
          You have pre-ordered a <strong> pass for {{book.route.notes.noPasses}} trips</strong> to show your support to activate this route. When <strong>{{book.route.notes.tier[0].pax}} people</strong> pre-order the pass, this route will activate.
        </p>
        <p>
            If the route is activated, it will
        </p>
        <div class="features">
          <ul>
            <li>
            start on <strong>{{book.route.trips[0].date | date:'dd MMM yyyy'}} ({{book.route.trips[0].date | date:'EEE'}})</strong>
            </li>
            <li>
            run every Mon - Fri, except public holidays
            </li>
            <li>
            operate for at least a month.
            </li>
          </ul>
        </div>
        <p>
          This campaign ends in <span ng-if="book.route.daysLeft && book.route.daysLeft>1">{{book.route.daysLeft}} days</span>
            <span ng-if="book.route.daysLeft && book.route.daysLeft==1">{{book.route.daysLeft}} day</span>. Payment for the  <strong>pass for {{book.route.notes.noPasses}} trips</strong> will only be deducted at the end of the campaign if the route is activated. You will not be charged if the route does not activate by <strong>{{book.route.notes.lelongExpiry | date:'dd MMM yy'}}</strong>.
        </p>
        <p>
          If activated, you will receive the pass in your account after payment is deducted. You can use it to <strong>book any {{book.route.notes.noPasses}} trips within the 1st month</strong> of the activated route.
        </p>
        <p>
            You will be notified via email about the route status as well.
        </p>
      </div>
    </div>

    <div class="item item-text-wrap">
      <div class="item-subtitle">Operated by</div>
      <div class="row">
        <div class="col-20 bus-logo">
          <img ng-src="{{book.companyInfo.id | companyLogo}}">
        </div>
        <div class="col-80 col-center bus-co-info">
          <p class="name">{{book.companyInfo.name}}</p>
          <p class="email">{{book.companyInfo.email}}</p>
        </div>
      </div>
    </div>

    <button class="primary-button button" ui-sref="tabs.kickstarter">
      Back to Main Menu
    </button>
  </ion-content>
</ion-view>
